<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AmbiqSuite User Guide: utils/am_util_faultisr.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="customdoxygen.css" rel="stylesheet" type="text/css" />
<link href="paramAlign.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="am_logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">AmbiqSuite User Guide<span id="projectnumber">&#160;R4.4.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_cbdb8362360e11eafe2fa3bc74cf0ffd.html">utils</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">am_util_faultisr.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>An extended hard-fault handler.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdint.h&gt;</code><br />
<code>#include &quot;am_mcu_apollo.h&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structam__fault__t.html">am_fault_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gab0d22b2275a4bc7b3d9391fc528e7134"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__faultisr.html#gab0d22b2275a4bc7b3d9391fc528e7134">AM_LOCAL_STACK</a></td></tr>
<tr class="separator:gab0d22b2275a4bc7b3d9391fc528e7134"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8c4ce712f1949c6da59b9582078fa2f2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__faultisr.html#ga8c4ce712f1949c6da59b9582078fa2f2">AM_REG_SYSCTRL_CFSR_O</a>&#160;&#160;&#160;0xE000ED28</td></tr>
<tr class="separator:ga8c4ce712f1949c6da59b9582078fa2f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac06ac103ebf215eb8af16d43f6056d39"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__faultisr.html#gac06ac103ebf215eb8af16d43f6056d39">AM_REG_SYSCTRL_BFAR_O</a>&#160;&#160;&#160;0xE000ED38</td></tr>
<tr class="separator:gac06ac103ebf215eb8af16d43f6056d39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6808fd81811d714c37574e39b467ee63"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__faultisr.html#ga6808fd81811d714c37574e39b467ee63">AM_REGVAL</a>(x)&#160;&#160;&#160;(*((volatile uint32_t *)(x)))</td></tr>
<tr class="separator:ga6808fd81811d714c37574e39b467ee63"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaa7ec15046d9056a13ddfcb1d6befa699"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__faultisr.html#gaa7ec15046d9056a13ddfcb1d6befa699">am_util_faultisr_collect_data</a> (uint32_t u32IsrSP)</td></tr>
<tr class="separator:gaa7ec15046d9056a13ddfcb1d6befa699"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3de43c57b30022f4aacfc20917cc03c9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__faultisr.html#ga3de43c57b30022f4aacfc20917cc03c9">am_valid_sp</a> (uint32_t u32IsrSP)</td></tr>
<tr class="separator:ga3de43c57b30022f4aacfc20917cc03c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga86bcc3461f14641cf13ffa091e9bf911"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__faultisr.html#ga86bcc3461f14641cf13ffa091e9bf911">am_util_stdio_printf</a> (char *pui8Fmt,...)</td></tr>
<tr class="separator:ga86bcc3461f14641cf13ffa091e9bf911"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ga6260c982d4a594d6ae8e98ed34c7ed99"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__faultisr.html#ga6260c982d4a594d6ae8e98ed34c7ed99">gFaultStack</a> [512]</td></tr>
<tr class="separator:ga6260c982d4a594d6ae8e98ed34c7ed99"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >An extended hard-fault handler. </p>
<p >This module is portable to all Ambiq Apollo products with minimal HAL or BSP dependencies (SWO output). It collects the fault information into the sHalFaultData structure, which it then prints to stdout (typically SWO).</p>
<p >By default this handler, when included in the build overrides the weak binding of the default hardfault handler. It allocates 512 bytes of global variable space for a local stack which guarantees diagnostic output under all hardfault conditions. If the local stack is not wanted/needed, remove the macro AM_LOCAL_STACK below. If the local stack is disabled, and the SP was invalid at the time of the hardfault, a second hardfault can occur before any diagnostic data is collected.</p>
<p >This handler outputs information about the state of the processor at the time the hardfault occurred to stdout (typically SWO). If output is not desired remove the macro AM_UTIL_FAULTISR_PRINT below. When prints are disabled, the fault information is available in the local sHalFaultData structure.</p>
<p >The handler does not return. After outputting the diagnostic information, it spins forever, it does not recover or try and return to the program that caused the hardfault.</p>
<p >Upon entry (caused by a hardfault), it switches to a local stack in case the cause of the hardfault was a stack related issue. The stack is sized large enough to provide for the local variables and the stack space needed for the ouput functions calls being used.</p>
<p >It is compiler/platform independent enabling it to be used with GCC, Keil, IAR and easily ported to other tools chains </p>
</div></div><!-- contents -->
<hr size="1">
    <body>
        <div id="footer" align="right">        
            <small>
                Generated on Fri Jul 7 2023 14:52:43 for the AmbiqSuite User Guide by&nbsp;
                <a href="http://www.ambiqmicro.com">
                <img class="footer" src="./ambiq_logo.png" alt="Ambiq"/></a>&nbsp&nbsp Copyright &copy; 2023&nbsp&nbsp<br />
                This documentation is licensed and distributed under the <a rel="license" href="http://opensource.org/licenses/BSD-3-Clause">BSD 3-Clause License</a>.&nbsp&nbsp<br/>
            </small>
        </div>
    </body>
</html>
