<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AmbiqSuite User Guide: Interrupt - ARM NVIC support functions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="customdoxygen.css" rel="stylesheet" type="text/css" />
<link href="paramAlign.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="am_logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">AmbiqSuite User Guide<span id="projectnumber">&#160;R4.4.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Interrupt - ARM NVIC support functions<div class="ingroups"><a class="el" href="group__hal.html">Hardware Abstraction Layer (HAL)</a> &raquo; <a class="el" href="group__apollo4p__hal.html">apollo4p</a></div></div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gad9f97791c7c3d71be4377a927a92048e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mcu__interrupt__4p.html#gad9f97791c7c3d71be4377a927a92048e">AM_HAL_INTERRUPT_MAX</a>&#160;&#160;&#160;(MAX_IRQn - 1)</td></tr>
<tr class="separator:gad9f97791c7c3d71be4377a927a92048e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2f3c5b59c5b45f8615ad135231495a1a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mcu__interrupt__4p.html#ga2f3c5b59c5b45f8615ad135231495a1a">AM_IRQ_PRIORITY_DEFAULT</a>&#160;&#160;&#160;4</td></tr>
<tr class="separator:ga2f3c5b59c5b45f8615ad135231495a1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaee7034be05b611c9eaaff003adcb7e65"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mcu__interrupt__4p.html#gaee7034be05b611c9eaaff003adcb7e65">am_hal_interrupt_master_disable</a> (void)</td></tr>
<tr class="memdesc:gaee7034be05b611c9eaaff003adcb7e65"><td class="mdescLeft">&#160;</td><td class="mdescRight">Globally disable interrupt service routines.  <a href="group__mcu__interrupt__4p.html#gaee7034be05b611c9eaaff003adcb7e65">More...</a><br /></td></tr>
<tr class="separator:gaee7034be05b611c9eaaff003adcb7e65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafc930cd4605c6d313c16b6bc52a51ba1"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mcu__interrupt__4p.html#gafc930cd4605c6d313c16b6bc52a51ba1">am_hal_interrupt_master_enable</a> (void)</td></tr>
<tr class="memdesc:gafc930cd4605c6d313c16b6bc52a51ba1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Globally enable interrupt service routines.  <a href="group__mcu__interrupt__4p.html#gafc930cd4605c6d313c16b6bc52a51ba1">More...</a><br /></td></tr>
<tr class="separator:gafc930cd4605c6d313c16b6bc52a51ba1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4c941417d163d57a8df75babdd795a79"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mcu__interrupt__4p.html#ga4c941417d163d57a8df75babdd795a79">am_hal_interrupt_master_set</a> (uint32_t ui32Level)</td></tr>
<tr class="memdesc:ga4c941417d163d57a8df75babdd795a79"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the master interrupt state based on the input.  <a href="group__mcu__interrupt__4p.html#ga4c941417d163d57a8df75babdd795a79">More...</a><br /></td></tr>
<tr class="separator:ga4c941417d163d57a8df75babdd795a79"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="gad9f97791c7c3d71be4377a927a92048e" name="gad9f97791c7c3d71be4377a927a92048e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad9f97791c7c3d71be4377a927a92048e">&#9670;&nbsp;</a></span>AM_HAL_INTERRUPT_MAX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AM_HAL_INTERRUPT_MAX&#160;&#160;&#160;(MAX_IRQn - 1)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Define the last peripheral interrupt as AM_HAL_INTERRUPT_MAX. The total number of interrupts in the vector table is therefore (AM_HAL_INTERRUPT_MAX + 1 + 16). </p>

</div>
</div>
<a id="ga2f3c5b59c5b45f8615ad135231495a1a" name="ga2f3c5b59c5b45f8615ad135231495a1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2f3c5b59c5b45f8615ad135231495a1a">&#9670;&nbsp;</a></span>AM_IRQ_PRIORITY_DEFAULT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AM_IRQ_PRIORITY_DEFAULT&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >For Apollo4 RevB, a workaround requires masking all interrupts. This is accomplished by setting a priority of 0, but assumes any other IRQs have a lower priority (&gt;0). This will assign a default priority for IRQs. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="gaee7034be05b611c9eaaff003adcb7e65" name="gaee7034be05b611c9eaaff003adcb7e65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaee7034be05b611c9eaaff003adcb7e65">&#9670;&nbsp;</a></span>am_hal_interrupt_master_disable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t am_hal_interrupt_master_disable </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Globally disable interrupt service routines. </p>
<p >This function prevents interrupt signals from the NVIC from triggering ISR entry in the CPU. This will effectively stop incoming interrupt sources from triggering their corresponding ISRs.</p>
<dl class="section note"><dt>Note</dt><dd>Any external interrupt signal that occurs while the master interrupt disable is active will still reach the "pending" state in the NVIC, but it will not be allowed to reach the "active" state or trigger the corresponding ISR. Instead, these interrupts are essentially "queued" until the next time the master interrupt enable instruction is executed. At that time, the interrupt handlers will be executed in order of decreasing priority.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>1 if interrupts were previously disabled, 0 otherwise.</dd></dl>
<p>Globally disable interrupt service routines.</p>
<p >To disable all interrupts in DSP, the interrupt level should be raised to a level higher the maximum level. Currently the maximum level is 6. This function raises the interrupt level to 15 to disable all interrupt (the PS register have 4 bits for interrupt level). Note: disabling interrupt can not disable the exceptions.</p>
<dl class="section return"><dt>Returns</dt><dd>the contents of PS register. </dd></dl>

</div>
</div>
<a id="gafc930cd4605c6d313c16b6bc52a51ba1" name="gafc930cd4605c6d313c16b6bc52a51ba1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafc930cd4605c6d313c16b6bc52a51ba1">&#9670;&nbsp;</a></span>am_hal_interrupt_master_enable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t am_hal_interrupt_master_enable </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Globally enable interrupt service routines. </p>
<p >This function allows interrupt signals from the NVIC to trigger ISR entry in the CPU. This function must be called if interrupts are to be serviced in software.</p>
<dl class="section return"><dt>Returns</dt><dd>1 if interrupts were previously disabled, 0 otherwise.</dd></dl>
<p>Globally enable interrupt service routines.</p>
<p >To enable all interrupts in DSP, the interrupt level should be set to zero. This function regardless of the current interrupt level, changes the interrupt level to zero. The interrupt level is specified by 4 bits inside PS register.</p>
<dl class="section return"><dt>Returns</dt><dd>the contents of PS register. </dd></dl>

</div>
</div>
<a id="ga4c941417d163d57a8df75babdd795a79" name="ga4c941417d163d57a8df75babdd795a79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4c941417d163d57a8df75babdd795a79">&#9670;&nbsp;</a></span>am_hal_interrupt_master_set()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void am_hal_interrupt_master_set </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ui32Level</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the master interrupt state based on the input. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ui32Level</td><td>- Desired PRIMASK value.</td></tr>
  </table>
  </dd>
</dl>
<p>This function directly writes the PRIMASK register in the ARM core. A value of 1 will disable interrupts, while a value of zero will enable them.</p>
<dl class="section note"><dt>Note</dt><dd>This function may be used along with <a class="el" href="group__mcu__interrupt__4b.html#gaee7034be05b611c9eaaff003adcb7e65" title="Globally disable interrupt service routines.">am_hal_interrupt_master_disable()</a> to implement a nesting critical section. To do this, call <a class="el" href="group__mcu__interrupt__4b.html#gaee7034be05b611c9eaaff003adcb7e65" title="Globally disable interrupt service routines.">am_hal_interrupt_master_disable()</a> to start the critical section, and save its ret value. To complete the critical section, call <a class="el" href="group__mcu__interrupt__4b.html#ga84b741ee65e74ecd95a065ac6876c862" title="Sets the master interrupt state based on the input.">am_hal_interrupt_master_set()</a> using the saved return value as <em>ui32Level</em>. This will safely restore PRIMASK to the value it contained just before the start of the critical section.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ui32InterruptState</td><td>- Desired PRIMASK value.</td></tr>
  </table>
  </dd>
</dl>
<p>This function directly writes the PRIMASK register in the ARM core. A value of 1 will disable interrupts, while a value of zero will enable them.</p>
<dl class="section note"><dt>Note</dt><dd>This function may be used along with <a class="el" href="group__mcu__interrupt__4b.html#gaee7034be05b611c9eaaff003adcb7e65" title="Globally disable interrupt service routines.">am_hal_interrupt_master_disable()</a> to implement a nesting critical section. To do this, call <a class="el" href="group__mcu__interrupt__4b.html#gaee7034be05b611c9eaaff003adcb7e65" title="Globally disable interrupt service routines.">am_hal_interrupt_master_disable()</a> to start the critical section, and save its ret value. To complete the critical section, call <a class="el" href="group__mcu__interrupt__4b.html#ga84b741ee65e74ecd95a065ac6876c862" title="Sets the master interrupt state based on the input.">am_hal_interrupt_master_set()</a> using the saved return value as <em>ui32InterruptState</em>. This will safely restore PRIMASK to the value it contained just before the start of the critical section.</dd></dl>
<p>Sets the master interrupt state based on the input.</p>
<p >The function can change the interrupt level to any level. By changing the interrupt level, all interrupts with the lower level are disabled.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ui32Level</td><td>- The required interrupt level </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the contents of PS register. </dd></dl>

</div>
</div>
</div><!-- contents -->
<hr size="1">
    <body>
        <div id="footer" align="right">        
            <small>
                Generated on Fri Jul 7 2023 14:52:43 for the AmbiqSuite User Guide by&nbsp;
                <a href="http://www.ambiqmicro.com">
                <img class="footer" src="./ambiq_logo.png" alt="Ambiq"/></a>&nbsp&nbsp Copyright &copy; 2023&nbsp&nbsp<br />
                This documentation is licensed and distributed under the <a rel="license" href="http://opensource.org/licenses/BSD-3-Clause">BSD 3-Clause License</a>.&nbsp&nbsp<br/>
            </small>
        </div>
    </body>
</html>
